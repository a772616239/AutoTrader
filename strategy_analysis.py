#!/usr/bin/env python3
"""
ç­–ç•¥åˆ†æè„šæœ¬ - ç”ŸæˆA1-A35ç­–ç•¥åˆ†ç±»Excelè¡¨
"""

import pandas as pd
from typing import Dict, List

def create_strategy_analysis():
    """åˆ›å»ºç­–ç•¥åˆ†æDataFrame"""

    # ç­–ç•¥æ•°æ®
    strategies = [
        {
            'ç®—æ³•åç§°': 'A1_åŠ¨é‡åè½¬ç­–ç•¥',
            'ç±»å‹': 'æ—¥å†…äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '4å°æ—¶',
            'æè¿°': 'åŸºäºRSIã€ä»·æ ¼åç¦»å’Œæˆäº¤é‡ç¡®è®¤çš„åŠ¨é‡åè½¬ç­–ç•¥ï¼Œé€‚ç”¨äºæ—¥å†…å¿«é€Ÿè¿›å‡º'
        },
        {
            'ç®—æ³•åç§°': 'A2_Z-Scoreå‡å€¼å›å½’',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '5å¤©',
            'æè¿°': 'åŸºäºä»·æ ¼åç¦»å‡å€¼çš„æ ‡å‡†å·®è¿›è¡Œå‡å€¼å›å½’äº¤æ˜“ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A3_åŒå‡çº¿æˆäº¤é‡çªç ´',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '1å°æ—¶',
            'æè¿°': 'ç»“åˆå¿«é€Ÿå‡çº¿äº¤å‰å’Œæˆäº¤é‡çªç ´è¯†åˆ«è¶‹åŠ¿ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A4_å›è°ƒäº¤æ˜“',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '5å¤©',
            'æè¿°': 'åŸºäºæ–æ³¢é‚£å¥‘å›æ’¤åœ¨ä¸Šæ¶¨è¶‹åŠ¿ä¸­ä¹°å…¥å›è°ƒï¼Œæˆ–åœ¨ä¸‹è·Œè¶‹åŠ¿ä¸­å–å‡ºåå¼¹ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A5_å¤šå› å­AIèåˆ',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '5å¤©',
            'æè¿°': 'æ•´åˆä»·æ ¼-æˆäº¤é‡å› å­ã€åŸºæœ¬é¢æŒ‡æ ‡ã€æ›¿ä»£æ•°æ®ä¿¡å·å’ŒAIé©±åŠ¨çš„å¤åˆè¯„åˆ†ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A6_æ–°é—»äº¤æ˜“',
            'ç±»å‹': 'æ—¥å†…äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': 'å¿«é€Ÿè¿›å‡º',
            'æè¿°': 'åŸºäºæ–°é—»æƒ…æ„Ÿåˆ†æå’Œä»·æ ¼æ³¢åŠ¨æ£€æµ‹çš„å¿«é€Ÿååº”ç­–ç•¥ï¼Œé€‚ç”¨äºæ—¥å†…äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A7_CTAè¶‹åŠ¿è·Ÿè¸ª',
            'ç±»å‹': 'é•¿çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '7å¤©',
            'æè¿°': 'åŸºäºå”å¥‡å®‰é€šé“çš„çªç ´äº¤æ˜“ç­–ç•¥ï¼Œç‰¹åˆ«é€‚ç”¨äºè¶‹åŠ¿å¸‚åœº'
        },
        {
            'ç®—æ³•åç§°': 'A8_RSIéœ‡è¡',
            'ç±»å‹': 'æ—¥å†…äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '1.5å°æ—¶',
            'æè¿°': 'åŸºäºç›¸å¯¹å¼ºå¼±æŒ‡æ•°æ£€æµ‹è¶…ä¹°è¶…å–ä¿¡å·çš„éœ‡è¡ç­–ç•¥ï¼Œé€‚ç”¨äºæ—¥å†…äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A9_MACDäº¤å‰',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '3å°æ—¶',
            'æè¿°': 'åŸºäºMACDæŒ‡æ ‡çš„çº¿æ¡äº¤å‰å’Œç›´æ–¹å›¾ä¿¡å·ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A10_å¸ƒæ—å¸¦çªç ´',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '2å°æ—¶',
            'æè¿°': 'åŸºäºå¸ƒæ—å¸¦æŒ‡æ ‡çš„ä»·æ ¼çªç ´ä¿¡å·ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A11_å‡çº¿äº¤å‰',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '2å°æ—¶',
            'æè¿°': 'åŸºäºçŸ­æœŸå’Œé•¿æœŸç§»åŠ¨å¹³å‡çº¿çš„äº¤å‰ä¿¡å·ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A12_Stochastic_RSI',
            'ç±»å‹': 'æ—¥å†…äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '2å°æ—¶',
            'æè¿°': 'åŸºäºéšæœºå¼ºå¼±æŒ‡æ•°çš„è¶…ä¹°è¶…å–ä¿¡å·ï¼Œé€‚ç”¨äºæ—¥å†…äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A13_EMAäº¤å‰',
            'ç±»å‹': 'é•¿çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '24å°æ—¶',
            'æè¿°': 'åŸºäºæŒ‡æ•°ç§»åŠ¨å¹³å‡çº¿äº¤å‰çš„å¤šèµ„äº§ç»„åˆç­–ç•¥ï¼Œé€‚ç”¨äºé•¿çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A14_RSIè¶‹åŠ¿çº¿',
            'ç±»å‹': 'é•¿çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '8å°æ—¶',
            'æè¿°': 'åŸºäºRSIå’Œé•¿æœŸè¶‹åŠ¿çš„ç­›é€‰ç­–ç•¥ï¼Œè½¬æ¢ä¸ºå®æ—¶äº¤æ˜“ï¼Œé€‚ç”¨äºé•¿çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A15_é…å¯¹äº¤æ˜“',
            'ç±»å‹': 'é•¿çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '30å¤©',
            'æè¿°': 'åŸºäºåæ•´å…³ç³»çš„ç»Ÿè®¡å¥—åˆ©ç­–ç•¥ï¼Œé€‚ç”¨äºé•¿çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A16_ROCåŠ¨é‡',
            'ç±»å‹': 'æ—¥å†…äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '2å°æ—¶',
            'æè¿°': 'åŸºäºä»·æ ¼å˜åŒ–ç‡(Rate of Change)çš„åŠ¨é‡ç­–ç•¥ï¼Œé€‚ç”¨äºæ—¥å†…äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A17_CCIé¡ºåŠ¿',
            'ç±»å‹': 'æ—¥å†…äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '2å°æ—¶',
            'æè¿°': 'åŸºäºé¡ºåŠ¿æŒ‡æ ‡(Commodity Channel Index)çš„è¶…ä¹°è¶…å–ç­–ç•¥ï¼Œé€‚ç”¨äºæ—¥å†…äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A18_Isolation_Forest',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '1å¤©',
            'æè¿°': 'åŸºäºæœºå™¨å­¦ä¹ çš„å¼‚å¸¸æ£€æµ‹ç­–ç•¥ï¼Œä½¿ç”¨Isolation Forestè¯†åˆ«ä»·æ ¼å¼‚å¸¸ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A22_è¶…çº§è¶‹åŠ¿',
            'ç±»å‹': 'é•¿çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '7å¤©',
            'æè¿°': 'åŸºäºATRçš„è¶‹åŠ¿è·Ÿè¸ªç­–ç•¥ï¼Œç‰¹åˆ«é€‚ç”¨äºè¶‹åŠ¿å¸‚åœº'
        },
        {
            'ç®—æ³•åç§°': 'A23_AroonæŒ¯è¡å™¨',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '10å¤©',
            'æè¿°': 'åŸºäºAroon OscillatoræŒ‡æ ‡çš„è¶‹åŠ¿è·Ÿè¸ªç­–ç•¥ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A24_Ultimate_Oscillator',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '7å¤©',
            'æè¿°': 'åŸºäºUltimate OscillatoræŒ‡æ ‡çš„åŠ¨é‡äº¤æ˜“ç­–ç•¥ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A25_åæ•´é…å¯¹äº¤æ˜“',
            'ç±»å‹': 'é•¿çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '30å¤©',
            'æè¿°': 'åŸºäºåæ•´æ£€éªŒçš„ç»Ÿè®¡å¥—åˆ©ç­–ç•¥ï¼Œé€‚ç”¨äºé•¿çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A26_Williams_R',
            'ç±»å‹': 'æ—¥å†…äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '10å¤©',
            'æè¿°': 'åŸºäºWilliams %RåŠ¨é‡æŒ‡æ ‡çš„äº¤æ˜“ç­–ç•¥ï¼Œé€‚ç”¨äºæ—¥å†…äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A27_Minerviniè¶‹åŠ¿',
            'ç±»å‹': 'é•¿çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '60å¤©',
            'æè¿°': 'åŸºäºMark Minerviniçš„è¶‹åŠ¿æ¨¡æ¿å’Œç›¸å¯¹å¼ºåº¦ç­›é€‰çš„äº¤æ˜“ç­–ç•¥ï¼Œé€‚ç”¨äºé•¿çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A28_True_Strength_Index',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '10å¤©',
            'æè¿°': 'åŸºäºTrue Strength IndexåŠ¨é‡æŒ‡æ ‡çš„äº¤æ˜“ç­–ç•¥ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A29_Stochastic_Oscillator',
            'ç±»å‹': 'æ—¥å†…äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '10å¤©',
            'æè¿°': 'åŸºäºStochastic OscillatoråŠ¨é‡æŒ‡æ ‡çš„äº¤æ˜“ç­–ç•¥ï¼Œé€‚ç”¨äºæ—¥å†…äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A30_IBD_RSè¯„çº§',
            'ç±»å‹': 'é•¿çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '30å¤©',
            'æè¿°': 'åŸºäºInvestors Business Dailyç›¸å¯¹å¼ºåº¦è¯„çº§çš„äº¤æ˜“ç­–ç•¥ï¼Œé€‚ç”¨äºé•¿çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A31_Money_Flow_Index',
            'ç±»å‹': 'æ—¥å†…äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '10å¤©',
            'æè¿°': 'åŸºäºMoney Flow IndexåŠ¨é‡æŒ‡æ ‡çš„äº¤æ˜“ç­–ç•¥ï¼Œé€‚ç”¨äºæ—¥å†…äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A32_Keltner_Channels',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '2å°æ—¶',
            'æè¿°': 'åŸºäºKeltner ChannelsæŒ‡æ ‡çš„ä»·æ ¼çªç ´å’Œè¶‹åŠ¿è·Ÿè¸ªä¿¡å·ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A33_Pivot_Points',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '2å°æ—¶',
            'æè¿°': 'åŸºäºPivot PointsæŒ‡æ ‡çš„æ”¯æ’‘é˜»åŠ›çªç ´ä¿¡å·ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A34_çº¿æ€§å›å½’',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '4å°æ—¶',
            'æè¿°': 'åŸºäºscikit-learnçº¿æ€§å›å½’æ¨¡å‹çš„ä»·æ ¼é¢„æµ‹å’Œäº¤æ˜“ä¿¡å·ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        },
        {
            'ç®—æ³•åç§°': 'A35_MLPç¥ç»ç½‘ç»œ',
            'ç±»å‹': 'çŸ­çº¿äº¤æ˜“',
            'æœ€å¤§æŒä»“æ—¶é—´': '5å°æ—¶',
            'æè¿°': 'åŸºäºscikit-learnå¤šå±‚æ„ŸçŸ¥å™¨ç¥ç»ç½‘ç»œçš„ä»·æ ¼é¢„æµ‹ç­–ç•¥ï¼Œé€‚ç”¨äºçŸ­çº¿äº¤æ˜“'
        }
    ]

    # åˆ›å»ºDataFrame
    df = pd.DataFrame(strategies)

    # æŒ‰ç±»å‹åˆ†ç»„ç»Ÿè®¡
    summary = df.groupby('ç±»å‹').size().reset_index(name='æ•°é‡')

    return df, summary

def save_to_excel():
    """ç”Ÿæˆå¹¶ä¿å­˜Excelæ–‡ä»¶"""
    df, summary = create_strategy_analysis()

    # åˆ›å»ºExcelå†™å…¥å™¨
    with pd.ExcelWriter('strategy_analysis.xlsx', engine='openpyxl') as writer:
        # ä¸»è¦æ•°æ®è¡¨
        df.to_excel(writer, sheet_name='ç­–ç•¥åˆ†ç±»', index=False)

        # ç»Ÿè®¡æ±‡æ€»è¡¨
        summary.to_excel(writer, sheet_name='ç»Ÿè®¡æ±‡æ€»', index=False)

        # æ ¼å¼åŒ–
        workbook = writer.book
        worksheet1 = writer.sheets['ç­–ç•¥åˆ†ç±»']
        worksheet2 = writer.sheets['ç»Ÿè®¡æ±‡æ€»']

        # è®¾ç½®åˆ—å®½
        for column in worksheet1.columns:
            max_length = 0
            column_letter = column[0].column_letter
            for cell in column:
                try:
                    if len(str(cell.value)) > max_length:
                        max_length = len(str(cell.value))
                except:
                    pass
            adjusted_width = min(max_length + 2, 50)  # æœ€å¤§å®½åº¦50
            worksheet1.column_dimensions[column_letter].width = adjusted_width

        for column in worksheet2.columns:
            max_length = 0
            column_letter = column[0].column_letter
            for cell in column:
                try:
                    if len(str(cell.value)) > max_length:
                        max_length = len(str(cell.value))
                except:
                    pass
            adjusted_width = min(max_length + 2, 30)
            worksheet2.column_dimensions[column_letter].width = adjusted_width

    print("âœ… ç­–ç•¥åˆ†æExcelæ–‡ä»¶å·²ç”Ÿæˆ: strategy_analysis.xlsx")
    print("\nğŸ“Š ç»Ÿè®¡æ±‡æ€»:")
    print(summary.to_string(index=False))

if __name__ == "__main__":
    save_to_excel()